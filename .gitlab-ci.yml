---
stages:
  - ssh-prepare
  - server
  - front
  - deploy

ssh-prepare:
  trigger:
    include:
      - local: ./prepare.yml
    strategy: depend
deploy:
  stage: deploy
  script:
    - echo 'deploy test'
  only:
    - master
server:
  stage: server
  script:
    - ssh vmProjetIntegrateurgrp0-1
    - echo 'server build'
  only:
    changes:
      - apps/backend/**/*
front:
  stage: front
  script:
    - ssh vmProjetIntegrateurgrp0-1
    - echo 'front build'
  only:
    changes:
      - apps/frontend/**/*
  dependencies:
    - ssh-prepare
